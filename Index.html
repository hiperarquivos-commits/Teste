<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>App Entregador</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
    #map { height: 300px; }
  </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-gray-100 min-h-screen">  <!-- Login -->  <div id="loginScreen" class="flex items-center justify-center h-screen">
    <div class="bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-xl w-80">
      <h1 class="text-xl font-bold mb-4 text-center">Login do Entregador</h1>
      <input id="username" type="text" placeholder="UsuÃ¡rio" class="w-full p-2 mb-2 border rounded">
      <input id="password" type="password" placeholder="Senha" class="w-full p-2 mb-4 border rounded">
      <button onclick="login()" class="w-full bg-red-500 hover:bg-red-600 text-white py-2 rounded">Entrar</button>
    </div>
  </div>  <!-- Dashboard -->  <div id="dashboard" class="hidden p-4 space-y-4">
    <div class="flex justify-between items-center">
      <h2 class="text-lg font-bold">Bem-vindo, <span id="userDisplay"></span></h2>
      <button onclick="toggleDarkMode()" class="bg-gray-700 text-white px-3 py-1 rounded">ðŸŒ™</button>
    </div><div class="grid grid-cols-2 gap-4">
  <div class="bg-white dark:bg-gray-800 p-4 rounded-xl shadow">
    <p class="text-gray-500">Saldo</p>
    <h2 id="saldo" class="text-2xl font-bold">R$ 0,00</h2>
  </div>
  <div class="bg-white dark:bg-gray-800 p-4 rounded-xl shadow">
    <p class="text-gray-500">Entregas</p>
    <h2 id="totalEntregas" class="text-2xl font-bold">0</h2>
  </div>
</div>

<!-- Mapa -->
<div id="map" class="rounded-xl shadow"></div>

<!-- Pedido atual -->
<div id="pedidoAtual" class="bg-white dark:bg-gray-800 p-4 rounded-xl shadow hidden animate-bounce">
  <h3 class="font-bold mb-2">Novo Pedido ðŸ“¦</h3>
  <p id="pedidoInfo"></p>
  <div class="flex gap-2 mt-2">
    <button onclick="aceitarPedido()" class="flex-1 bg-green-500 text-white p-2 rounded">Aceitar</button>
    <button onclick="rejeitarPedido()" class="flex-1 bg-red-500 text-white p-2 rounded">Rejeitar</button>
  </div>
</div>

<!-- HistÃ³rico -->
<div class="bg-white dark:bg-gray-800 p-4 rounded-xl shadow">
  <h3 class="font-bold mb-2">HistÃ³rico de Entregas</h3>
  <ul id="historico" class="space-y-2 text-sm"></ul>
</div>

  </div><audio id="notifSound" src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg"></audio>

  <script>
    let saldo = 0;
    let totalEntregas = 0;
    let historico = [];
    let map, marker;

    function login(){
      const user = document.getElementById('username').value;
      document.getElementById('userDisplay').innerText = user;
      document.getElementById('loginScreen').classList.add('hidden');
      document.getElementById('dashboard').classList.remove('hidden');
      initMap();
      simularPedidos();
      pedirPermissaoNotificacao();
    }

    function initMap(){
      map = L.map('map').setView([-20.4697, -54.6201], 13);
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: 'Â© OpenStreetMap'
      }).addTo(map);
    }

    function simularPedidos(){
      setInterval(()=>{
        if(Math.random() > 0.5){
          document.getElementById('pedidoAtual').classList.remove('hidden');
          document.getElementById('pedidoInfo').innerText = "Retirada no KFC - Shopping CG â†’ Entrega Vila Margarida (R$ 21,19)";
          if(marker) map.removeLayer(marker);
          marker = L.marker([-20.468, -54.620]).addTo(map).bindPopup("Pedido KFC").openPopup();
          tocarNotificacao();
          mostrarNotificacao("Novo pedido disponÃ­vel!", { body: "R$ 21,19 para Vila Margarida" });
        }
      },10000);
    }

    function aceitarPedido(){
      saldo += 21.19;
      totalEntregas++;
      historico.push({valor:21.19, destino:"Vila Margarida"});
      atualizarDashboard();
      document.getElementById('pedidoAtual').classList.add('hidden');
    }

    function rejeitarPedido(){
      document.getElementById('pedidoAtual').classList.add('hidden');
    }

    function atualizarDashboard(){
      document.getElementById('saldo').innerText = `R$ ${saldo.toFixed(2)}`;
      document.getElementById('totalEntregas').innerText = totalEntregas;
      const lista = document.getElementById('historico');
      lista.innerHTML = '';
      historico.forEach((h,i)=>{
        const li = document.createElement('li');
        li.innerText = `Entrega ${i+1}: ${h.destino} - R$ ${h.valor.toFixed(2)}`;
        lista.appendChild(li);
      });
    }

    function toggleDarkMode(){
      document.body.classList.toggle('dark');
    }

    function tocarNotificacao(){
      document.getElementById('notifSound').play();
    }

    function pedirPermissaoNotificacao(){
      if ("Notification" in window && Notification.permission !== "granted") {
        Notification.requestPermission();
      }
    }

    function mostrarNotificacao(titulo, opcoes){
      if ("Notification" in window && Notification.permission === "granted") {
        new Notification(titulo, opcoes);
      }
    }
  </script></body>
</html>
